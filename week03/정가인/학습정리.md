**3주차 JS**
**동기와 비동기처리, 콜백함수와 promise, 이벤트루프**

1. **동기와 비동기**
   동기처리 : 코드가 한 줄씩 차례대로 실행, 앞 코드가 끝나야 다음 코드 실행(시간이 오래 걸림)
   <예시>
   console.log("1");
   console.log("2"); # 1 -> 2

   비동기처리 : 특정 작업이 끝나길 기다리지 않고 다음 코드 실행, 나중에 결과가 오면 알려줌
   <예시1>
   setTimeout(() => {
   console.log("1"); // 1초 뒤 실행
   }, 1000);
   console.log("2"); // 출력 결과: 2 → 1

   <예시2>
   function echo(str) {
   setTimeout(() => {
   console.log(str);
   }, 2000 \* Math.random()); // 랜덤 시간 후 출력
   }

   echo('타코');
   echo('캣');
   echo('고트');
   echo('치즈');
   echo('피자');

2. **비동기 Promise, 콜백함수, async/await**
   **Promise**
   : 비동기 작업을 처리하는데 사용되는 객체

   - 생성자이기에 new키워드와 생성자를 통해 만들 수 있음, 인자로 콜백 넣을 수 있음
     resolve : 정상적인 결과 값 반환(이행)
     reject : 정상적이지 않았던 값 반환(거부)

   상태

   - 대기(pending) : 비동기 작업 처리 중
   - 이행(fulfilled) : 비동기 작업 정상적으로 처리된 경우
   - 거부(rejected) : 비동기 작업 정상적으로 처리되지 않은 경우

   메소드

   - then() : 이행된 경우
   - catch() : 거부된 경우
   - finally() : 이행, 거부되더라도 항상

   <예시>
   const myPromise = new Promise((resolve, reject) => {
   setTimeout(() => {
   const text = prompt('"안녕"을 입력해봐');
   if (text === '안녕') {
   resolve('안녕 나도 반가워!');
   } else {
   reject('다시 입력해');
   }
   }, 2000);
   });

myPromise
.then((result) => {
console.log('성공:', result);
})
.catch((error) => {
console.log('실패:', error);
});

**콜백함수**
: 다른 함수의 인자로 넘겨지고 해당 함수가 처리된 후 호출되는 함수
<예시>
function exampleFunction(callback) {
console.log('출력 시작');
setTimeout(() => {
console.log('작업1');
console.log('작업2');
callback();
}, 2000); // 2초 대기
console.log('출력 종료');
}

exampleFunction(() => {
console.log('콜백 시작');
});
console.log('콜백 종료');
=> 비동기라 출력시작-출력 종료-콜백 종료-작업1-작업2-콜백시작 순으로 출력됨

**Async/Await**
: 문법적 설탕과 같음, 코드를 더 읽기 쉽게 작성하고 이해할 수 있도록 도와주는 문법적인 표현방식

<예시>
async function runAsyncAwait() {
try {
const user = await getnumber(1); // 사용자 정보
const name = await getname(user.name); // 이름 요청

      console.log('user: ', user);
      console.log('name: ', name);

       return user;

} catch (error) {
console.log('error: ', error);
}
}

console.log('start');

runAsyncAwait().then(user => console.log('user: ', user));

console.log('end');

3. **비동기 처리를 위한 JavaScript 엔진의 동작 방식**

   - 콜 스택 : 실행 중인 함스들이 쌓이는 곳
   - 콜백 큐 : 비동기 작업 완료 후 실행한 함수의 대기열
   - 이벤트 루프 : 콜 스택이 비면 대기 중인 작업을 실행하게 함
   - 마이크로태스크 큐 : 프로미스 콜백들이 들어가는 우선순위의 큐

   자바스크립트는 단일 스레드이기에 한 줄씩 순서대로 코드를 실행함.
   그래서 오래 걸리는 작업의 경우 중간에 멈춤 -> 동기가 아닌 비동기 처리 사용
   오래 걸리는 작업의 경우 setTimeout, fetch활용해서 브라우저에 맡김
   브라우저가 작업을 끝내면 콜백을 콜백 큐에 넣음
   자바스크립트가 하던 일이 다 마치고 콜 스택이 비면 콜백 큐에 있는 함수를 실행함
   이때 프로미스는 콜백을 조금 더 빠르게 실행함
